<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel - Lucky Draw</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f0f0f0;
    }
    h2 {
      margin-top: 0;
    }
    input[type="file"], input[type="text"], input[type="color"], input[type="range"] {
      margin: 8px 0 16px;
      display: block;
    }
    button {
      margin-bottom: 10px;
      padding: 10px 16px;
      border: none;
      background-color: #28a745;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>
  <h2>ğŸ› Admin Panel</h2>

  <label for="volumeSlider">ğŸ”Š Background Music Volume:</label>
  <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1"/>

  <button onclick="triggerUpload('bg')">ğŸ“· Upload Background</button>
  <input type="file" id="bgUpload" accept="image/*" style="display:none" onchange="uploadFile('bg', event)" />

  <button onclick="triggerUpload('names')">ğŸ“„ Upload Name List</button>
  <input type="file" id="nameUpload" accept=".txt" style="display:none" onchange="uploadFile('names', event)" />

  <button onclick="postMessageToMain('exportNames')">ğŸ’¾ Export Names</button>

  <label for="editTitleInput">ğŸ“ Edit Title:</label>
  <input type="text" id="editTitleInput" oninput="updateTitle(this.value)" />

  <label for="titleColorPicker">ğŸ¨ Title Color:</label>
  <input type="color" id="titleColorPicker" onchange="postColor('titleColor', this.value)" />

  <label for="winnerFontColorPicker">ğŸ† Winner Font Color:</label>
  <input type="color" id="winnerFontColorPicker" onchange="postColor('winnerFontColor', this.value)" />

  <script>
    const mainWindow = window.opener || window.parent;

    function postMessageToMain(type, data = null) {
      mainWindow.postMessage({ type, data }, "*");
    }

    function updateTitle(value) {
      postMessageToMain("updateTitle", value);
    }

    function postColor(type, color) {
      postMessageToMain(type, color);
    }

    function triggerUpload(kind) {
      document.getElementById(kind === 'bg' ? 'bgUpload' : 'nameUpload').click();
    }

    function uploadFile(type, event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        postMessageToMain(type === 'bg' ? 'uploadBackground' : 'uploadNameList', reader.result);
      };
      reader.readAsDataURL(file);
    }

    document.getElementById('volumeSlider').addEventListener('input', e => {
      postMessageToMain('bgVolume', e.target.value);
    });
  </script>
</body>
</html>
